{# Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you
may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. #} {% extends 'appbuilder/init.html' %} {% import 'appbuilder/baselib.html' as baselib %} {% block body %} {% include
'appbuilder/general/confirm.html' %} {% include 'appbuilder/general/alert.html' %} {% block navbar %} {% include 'appbuilder/navbar.html' %} {% endblock %} {% block uncontained %}{% endblock %}

<div class="container">
    <div class="row">{% block messages %} {% include 'superset/flash_wrapper.html' %} {% endblock %} {% block content %} {% endblock %}</div>
</div>
<div class="container-fluid">{% block content_fluid %} {% endblock %}</div>
<div id="app" data-bootstrap="{{ bootstrap_data() }}"></div>
<script>
    window.addEventListener("message", function (event) {
        const message = event.data;
        if (message?.ask === "locationStatus") {
            event.source.postMessage({ locationStatus: window.location.pathname }, event.origin);
        }
    });

    // login google
    // function preventGoogleRedirect() {
    // console.log("inside prevent google redirect");
    // var xhr = new XMLHttpRequest();
    // // xhr.withCredentials = true;
    // xhr.followRedirects = false;
    // // Set up a function to add cookies to the request
    // function addCookiesToRequest() {
    //     var cookies = document.cookie; // Get the cookies from your document or any source
    //     // xhr.setRequestHeader("Cookie", cookies);
    //     xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
    //     xhr.setRequestHeader("Access-Control-Allow-Origin", "*");
    // }
    // xhr.addEventListener("readystatechange", function () {
    //     console.log("inside listener");
    //     if (xhr.readyState === XMLHttpRequest.DONE) {
    //         console.log("request done");
    //         var redirectUrl = xhr.getResponseHeader("Location");
    //         if (redirectUrl) {
    //             // Perform your desired action with the redirect URL
    //             console.log("Received a 302 response. Redirect URL:", redirectUrl);
    //         }
    //     } else if (xhr.status === 200) {
    //         // Request was successful, handle the response here
    //         console.log("Received a 200 response. Response:", xhr.responseText);
    //     } else {
    //         // Handle other response statuses here
    //         console.log("Received a response with status:", xhr.status, xhr.response);
    //     }
    // });
    // xhr.open("GET", "http://localhost:8088/login/google?next=");
    // // Before sending the request, add cookies to the request headers
    // addCookiesToRequest();
    // xhr.send();
    // var xhr = new XMLHttpRequest();
    // xhr.withCredentials = true;
    // xhr.followRedirects = false;
    // xhr.addEventListener("readystatechange", function () {
    //     console.log("response xml", xhr.responseXML);
    //     console.log("status", xhr.status);
    //     console.log("status text", xhr.statusText);
    //     console.log("response", xhr.response);
    //     if (xhr.readyState === XMLHttpRequest.DONE) {
    //         console.log("request done");
    //         var redirectUrl = xhr.getResponseHeader("location");
    //         if (redirectUrl) {
    //             // Perform your desired action with the redirect URL
    //             console.log("Received a 302 response. Redirect URL:", redirectUrl);
    //         }
    //     } else if (xhr.status === 200) {
    //         // Request was successful, handle the response here
    //         console.log("Received a 200 response. Response:", xhr.responseText);
    //     } else {
    //         // Handle other response statuses here
    //         console.log("headers", xhr.getResponseHeader("location"));
    //         console.log("Received a response with status:", xhr.status, xhr.response);
    //     }
    //     console.log("headers", xhr.getResponseHeader("location"));
    //     console.log("headers", xhr.getResponseHeader("Location"));
    // });
    // xhr.open("GET", "http://localhost:8088/login/google?next=", true);
    // xhr.send();
    // fetch("http://localhost:8088/login/google?next=", {
    //     method: "GET",
    //     redirect: "manual", // Prevent automatic redirection
    //     headers: new Headers(),
    // })
    //     .then((response) => {
    //         console.log("response status", response.status, response);
    //         var url = new URL(response.url);
    //         console.log("href", url.href);
    //         if (response.status === 302) {
    //             // Headers from the redirection response
    //             const redirectionHeaders = response.headers;
    //             console.log("Headers from the redirection response:", redirectionHeaders);
    //             // You can access specific headers like this:
    //             const locationHeader = redirectionHeaders.get("Location");
    //             console.log("Redirection Location:", locationHeader);
    //         } else {
    //             // Handle non-302 response statuses
    //             console.log(response.headers);
    //             console.log("Received a response with status:", response.status);
    //         }
    //         return response.text();
    //     })
    //     .then((result) => console.log(result))
    //     .catch((error) => {
    //         console.log("Error:", error);
    //     });
    // }
</script>

{% block footer %}
<footer>
    <div class="img-rounded nav-fixed-bottom">
        <div class="container-fluid">{% include 'appbuilder/footer.html' %}</div>
    </div>
</footer>
{% endblock %} {% endblock %}
